
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 2: Booting &#8212; CSIC30016: Operating System Capstone</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/lab2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 3: Exception and Interrupt" href="lab3.html" />
    <link rel="prev" title="Lab 1: Hello World" href="lab1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">CSIC30016: Operating System Capstone</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Class:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class/staff.html">Staff</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab0.html">Lab 0: Environment Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1.html">Lab 1: Hello World</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 2: Booting</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">Lab 3: Exception and Interrupt</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab4.html">Lab 4: Allocator</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5.html">Lab 5: Thread and User Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab6.html">Lab 6: Virtual Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab7.html">Lab 7: Virtual File System</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="hardware/index.html">Hardware</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware/asm.html">The Assembly You Need</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardware/mailbox.html">Mailbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardware/uart.html">UART</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references/external_resources.html">External Resourses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/old_course.html">Old Course Websites</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/labs/lab2.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 2: Booting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-of-this-lab">Goals of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-a-kernel-is-loaded-on-rpi3">How a Kernel is Loaded on Rpi3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercises">Basic Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-1-reboot-10">Basic Exercise 1 - Reboot - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-2-uart-bootloader-30">Basic Exercise 2 - UART Bootloader - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#config-kernel-loading-setting">Config Kernel Loading Setting</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-3-initial-ramdisk-30">Basic Exercise 3 - Initial Ramdisk - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#new-ascii-format-cpio-archive">New ASCII Format Cpio Archive</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-cpio-archive">Loading Cpio Archive</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-4-simple-allocator-10">Basic Exercise 4 - Simple Allocator - 10%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercises">Advanced Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-1-bootloader-self-relocation-10">Advanced Exercise 1 - Bootloader Self Relocation - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-2-devicetree-30">Advanced Exercise 2 - Devicetree - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#format">Format</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing">Parsing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dtb-loading">Dtb Loading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="lab-2-booting">
<h1>Lab 2: Booting<a class="headerlink" href="#lab-2-booting" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Booting is the process to set up the environment to run various user programs after a computer reset.
It includes a kernel loaded by bootloader, subsystems initialization, device-driver matching, and loading the init user program to bring
up the remaining services in userspace.</p>
<p>In Lab 2, you’ll learn one of the methods to load your kernel and user programs.
Also, you’ll learn how to match a device to a driver on rpi3.
The initialization of the remaining subsystems will be introduced at later labs.</p>
</section>
<section id="goals-of-this-lab">
<h2>Goals of this lab<a class="headerlink" href="#goals-of-this-lab" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Implement a bootloader that loads kernel images through UART.</p></li>
<li><p>Implement a simple allocator.</p></li>
<li><p>Understand what’s initial ramdisk.</p></li>
<li><p>Understand what’s devicetree.</p></li>
</ul>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<section id="how-a-kernel-is-loaded-on-rpi3">
<h3>How a Kernel is Loaded on Rpi3<a class="headerlink" href="#how-a-kernel-is-loaded-on-rpi3" title="Link to this heading">#</a></h3>
<p>There are 4 steps before your kernel starts its execution.</p>
<ol class="arabic simple">
<li><p>GPU executes the first stage bootloader from ROM on the SoC.</p></li>
<li><p>The first stage bootloader recognizes the FAT16/32 file system and loads the second stage bootloader bootcode.bin from SD card to L2 cache.</p></li>
<li><p>bootcode.bin initializes SDRAM and loads start.elf</p></li>
<li><p>start.elf reads the configuration to load a kernel and other data to memory then wakes up CPUs to start execution.</p></li>
</ol>
<p>The kernel loaded at step 4 can also be another bootloader with more powerful functionalities such as network booting, or ELF loading.</p>
<p>In Lab 2, you’ll implement a bootloader that loads the actual kernel through UART, and it’s loaded by the previous stage bootloader.</p>
</section>
</section>
<section id="basic-exercises">
<h2>Basic Exercises<a class="headerlink" href="#basic-exercises" title="Link to this heading">#</a></h2>
<section id="basic-exercise-1-reboot-10">
<h3>Basic Exercise 1 - Reboot - 10%<a class="headerlink" href="#basic-exercise-1-reboot-10" title="Link to this heading">#</a></h3>
<p>Rpi3 doesn’t originally provide an on board reset button.</p>
<p>You can follow this example code to reset your rpi3.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This snippet of code only works on real rpi3, not on QEMU.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define PM_PASSWORD 0x5a000000</span>
<span class="cp">#define PM_RSTC 0x3F10001c</span>
<span class="cp">#define PM_WDOG 0x3F100024</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">volatile</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">addr</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">tick</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                 </span><span class="c1">// reboot after watchdog timer expire</span>
<span class="w">    </span><span class="n">set</span><span class="p">(</span><span class="n">PM_RSTC</span><span class="p">,</span><span class="w"> </span><span class="n">PM_PASSWORD</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mh">0x20</span><span class="p">);</span><span class="w">  </span><span class="c1">// full reset</span>
<span class="w">    </span><span class="n">set</span><span class="p">(</span><span class="n">PM_WDOG</span><span class="p">,</span><span class="w"> </span><span class="n">PM_PASSWORD</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tick</span><span class="p">);</span><span class="w">  </span><span class="c1">// number of watchdog tick</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">cancel_reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">set</span><span class="p">(</span><span class="n">PM_RSTC</span><span class="p">,</span><span class="w"> </span><span class="n">PM_PASSWORD</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// full reset</span>
<span class="w">    </span><span class="n">set</span><span class="p">(</span><span class="n">PM_WDOG</span><span class="p">,</span><span class="w"> </span><span class="n">PM_PASSWORD</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// number of watchdog tick</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Add a &lt;reboot&gt; command.</p>
</div>
</section>
<section id="basic-exercise-2-uart-bootloader-30">
<h3>Basic Exercise 2 - UART Bootloader - 30%<a class="headerlink" href="#basic-exercise-2-uart-bootloader-30" title="Link to this heading">#</a></h3>
<p>In Lab 1, you might experience the process of moving the SD card between your host and rpi3 very often during debugging.
You can eliminate this by introducing another bootloader to load the kernel under debugging.</p>
<p>To send binary through UART, you should devise a protocol to read raw data.
It rarely drops data during transmission, so you can keep the protocol simple. Here is a simple example of what a protocol might look like.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">header</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;III&#39;</span><span class="p">,</span>
    <span class="mh">0x544F4F42</span><span class="p">,</span>           <span class="c1"># &quot;BOOT&quot; in hex</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">kernel_data</span><span class="p">),</span>     <span class="c1"># size</span>
    <span class="n">checksum</span>             <span class="c1"># checksum</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can effectively write data from the host to the Raspberry Pi 3 through the serial device’s device file in Linux by creating a Python script to communicate with the bootloader.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/dev/ttyUSB0&#39;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="n">buffering</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">tty</span><span class="p">:</span>
  <span class="n">tty</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>After compiling bootloader.img, we can first use QEMU to test its functionality before running it on actual hardware.
You can use <code class="docutils literal notranslate"><span class="pre">qemu-system-aarch64</span> <span class="pre">-machine</span> <span class="pre">raspi3b</span> <span class="pre">-kernel</span> <span class="pre">your_bootloader.img</span> <span class="pre">-serial</span> <span class="pre">null</span> <span class="pre">-serial</span> <span class="pre">pty</span></code> to create a pseudo TTY device and test your bootloader through it.</p>
</div>
<section id="config-kernel-loading-setting">
<h4>Config Kernel Loading Setting<a class="headerlink" href="#config-kernel-loading-setting" title="Link to this heading">#</a></h4>
<p>You may still want to load your actual kernel image at 0x80000, but it then overlaps with your bootloader.
You can first specify the start address to another by <strong>re-writing the linker script</strong>.
Then, add <code class="docutils literal notranslate"><span class="pre">config.txt</span></code> file to your SD card’s boot partition to specify the loading address by <code class="docutils literal notranslate"><span class="pre">kernel_address=</span></code>. (By default, if no address is specified in config.txt, the image will be loaded at 0x80000.)</p>
<p>To further make your bootloader less ambiguous with the actual kernel, you can add the loading image name by
<code class="docutils literal notranslate"><span class="pre">kernel=</span></code> and <code class="docutils literal notranslate"><span class="pre">arm_64bit=1</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>kernel_address=0x60000
kernel=bootloader.img
arm_64bit=1
</pre></div>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Implement a UART bootloader that loads kernel images through UART.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>UART is a low-speed interface. It’s okay to send your kernel image because it’s quite small. Don’t use it to send large binary files.</p>
</div>
</section>
</section>
<section id="basic-exercise-3-initial-ramdisk-30">
<h3>Basic Exercise 3 - Initial Ramdisk - 30%<a class="headerlink" href="#basic-exercise-3-initial-ramdisk-30" title="Link to this heading">#</a></h3>
<p>After a kernel is initialized, it mounts a root filesystem and runs an init user program.
The init program can be a script or executable binary to bring up other services or load other drivers later on.</p>
<p>However, you haven’t implemented any filesystem and storage driver code yet, so you can’t load anything from the SD card using your kernel.
Another approach is loading user programs through the initial ramdisk.</p>
<p>An initial ramdisk is a file loaded by a bootloader or embedded in a kernel.
It’s usually an archive that can be extracted to build a root filesystem.</p>
<section id="new-ascii-format-cpio-archive">
<h4>New ASCII Format Cpio Archive<a class="headerlink" href="#new-ascii-format-cpio-archive" title="Link to this heading">#</a></h4>
<p>Cpio is a very simple archive format to pack directories and files.
Each directory and file is recorded as <strong>a header followed by its pathname and content</strong>.</p>
<p>In Lab 2, you are going to use the New ASCII Format Cpio format to create a cpio archive.
You can first create a <code class="docutils literal notranslate"><span class="pre">rootfs</span></code> directory and put all files you need inside it.
Then, use the following commands to archive it.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>rootfs
find<span class="w"> </span>.<span class="w"> </span><span class="p">|</span><span class="w"> </span>cpio<span class="w"> </span>-o<span class="w"> </span>-H<span class="w"> </span>newc<span class="w"> </span>&gt;<span class="w"> </span>../initramfs.cpio
<span class="nb">cd</span><span class="w"> </span>..
</pre></div>
</div>
<p><a class="reference external" href="https://www.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=5">Freebsd’s man page</a> has a detailed definition of how
New ASCII Format Cpio Archive is structured.
You should read it and implement a parser to read files in the archive. The New ASCII Format has its header format defined as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>struct<span class="w"> </span>cpio_newc_header<span class="w"> </span><span class="o">{</span>
<span class="w">   </span>char<span class="w">    </span>c_magic<span class="o">[</span><span class="m">6</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_ino<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_mode<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_uid<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_gid<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_nlink<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_mtime<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_filesize<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_devmajor<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_devminor<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_rdevmajor<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_rdevminor<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_namesize<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w">   </span>char<span class="w">    </span>c_check<span class="o">[</span><span class="m">8</span><span class="o">]</span><span class="p">;</span>
<span class="w"> </span><span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
<p>Please note that a NUL byte is appended to the pathname to ensure that the combined size of the fixed header and the pathname is a multiple of 4. Similarly, file data is also padded to align with a 4-byte boundary.</p>
</section>
<section id="loading-cpio-archive">
<h4>Loading Cpio Archive<a class="headerlink" href="#loading-cpio-archive" title="Link to this heading">#</a></h4>
<p><strong>QEMU</strong></p>
<p>Add the argument <code class="docutils literal notranslate"><span class="pre">-initrd</span> <span class="pre">&lt;cpio</span> <span class="pre">archive&gt;</span></code> to QEMU.
QEMU loads the cpio archive file to 0x8000000 by default.</p>
<p><strong>Rpi3</strong></p>
<p>Move the cpio archive into SD card.
Then specify the name and loading address in <code class="docutils literal notranslate"><span class="pre">config.txt</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>initramfs initramfs.cpio 0x20000000
</pre></div>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Parse New ASCII Format Cpio archive, and read file’s content given file’s pathname.</p>
</div>
<img alt="../_images/lab2_example1.png" src="../_images/lab2_example1.png" />
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In Lab 2, you only need to <strong>put some plain text files inside your archive</strong> to test the functionality.
In the later labs, you will also put script files and executables inside to automate the testing.</p>
</div>
</section>
</section>
<section id="basic-exercise-4-simple-allocator-10">
<h3>Basic Exercise 4 - Simple Allocator - 10%<a class="headerlink" href="#basic-exercise-4-simple-allocator-10" title="Link to this heading">#</a></h3>
<p>Kernel needs an allocator in the progress of subsystem initialization. However, the dynamic allocator is also a subsystem that need to be initialized. So we need a simple allocator in the early stage of booting.</p>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Implement a alloc function that returns a pointer points to a continuous space for requested size.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Your allocator don’t need to support free function.</p>
</div>
<p>The folloing code is a breif example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">simple_malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">simple_alloc</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this simple allocator, the heap is a pre-allocated memory pool used for dynamic memory requests.
We can request memory dynamically from the pool by passing a size argument. The allocator works by linearly allocating memory and ensuring that the requested allocation does not exceed the available space in the heap, and the function returns a pointer to the allocated memory.</p>
</section>
</section>
<section id="advanced-exercises">
<h2>Advanced Exercises<a class="headerlink" href="#advanced-exercises" title="Link to this heading">#</a></h2>
<section id="advanced-exercise-1-bootloader-self-relocation-10">
<h3>Advanced Exercise 1 - Bootloader Self Relocation - 10%<a class="headerlink" href="#advanced-exercise-1-bootloader-self-relocation-10" title="Link to this heading">#</a></h3>
<p>In the basic part, you are allowed to specify the loading address of your bootloader in <code class="docutils literal notranslate"><span class="pre">config.txt</span></code>.
However, not all previous stage bootloaders can specify the loading address.
Hence, a bootloader should be able to relocate itself to another address, so it can load a kernel to an address overlapping with its loading address.</p>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Add self-relocation to your UART bootloader, so you don’t need <code class="docutils literal notranslate"><span class="pre">kernel_address=</span></code> option in <code class="docutils literal notranslate"><span class="pre">config.txt</span></code>. Please ensure the bootloader’s initial loading address overlaps with the kernel image’s loading address, then relocate the bootloader to a different memory address.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may implement the relocation through assembly.</p>
</div>
</section>
<section id="advanced-exercise-2-devicetree-30">
<h3>Advanced Exercise 2 - Devicetree - 30%<a class="headerlink" href="#advanced-exercise-2-devicetree-30" title="Link to this heading">#</a></h3>
<p>During the booting process, a kernel should know what devices are currently connected and use the corresponding driver to initialize and access it.
For powerful buses such as PCIe and USB, the kernel can detect what devices are connected by querying the bus’s registers.
Then, it matches the device’s name with all drivers and uses the compatible driver to initialize and access the device.</p>
<p>However, for a computer system with a simple bus, a kernel can’t detect what devices are connected.
One approach to drive these devices is as you did in Lab 1;
developers know what’s the target machine to be run on and hard code the io memory address in their kernel.
It turns out the driver code becomes not portable.</p>
<p>A cleaner approach is a file describing what devices are on a computer system.
Also, it records the properties and relationships between each device.
Then, a kernel can query this file as querying like powerful bus systems to load the correct driver.
The file is called <strong>deivcetree</strong>.</p>
<section id="format">
<h4>Format<a class="headerlink" href="#format" title="Link to this heading">#</a></h4>
<p>Devicetree has two formats <strong>devicetree source(dts)</strong> and <strong>flattened devicetree(dtb)</strong>.
Devicetree source describes device tree in human-readable form.
It’s then compiled into flattened devicetree so the parsing can be simpler and faster in slow embedded systems.</p>
<p>You can read rpi3’s dts from raspberry pi’s
<a class="reference external" href="https://github.com/raspberrypi/linux/blob/rpi-6.6.y/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts">linux repository</a>.</p>
<p>You can get rpi3’s dtb by either compiling it manually or downloading the <a class="reference external" href="https://github.com/raspberrypi/firmware/raw/master/boot/bcm2710-rpi-3-b-plus.dtb">off-the-shelf one</a>.</p>
</section>
<section id="parsing">
<h4>Parsing<a class="headerlink" href="#parsing" title="Link to this heading">#</a></h4>
<p>In this advanced part, you should implement a parser to parse the flattened devicetree.
Besides, your kernel should provide an interface that takes a callback function argument.
So a driver code can walk the entire devicetree to query each device node and match itself by checking the node’s name and properties.</p>
<p>You can get the latest specification from the <a class="reference external" href="https://devicetree-specification.readthedocs.io/en/stable/flattened-format.html">devicetree’s official website</a>.
Please refer to Chapters 5, 2, and 3 in that order for more implementation details on building your parser.</p>
<p>The structure of the Devicetree .dtb file is illustrated below (Fig. 5.1):</p>
<img alt="../_images/lab2_dtb_layout.png" src="../_images/lab2_dtb_layout.png" />
<p>The structure is further divided into the FTD header, memory reservation block, structure block, and strings block.
Here, we primarily utilize the structure block and strings block to obtain device information, which can be accessed through the header.</p>
<p>The Flattened Devicetree Header Fields are as follows (<a class="reference external" href="https://devicetree-specification.readthedocs.io/en/stable/flattened-format.html#header">5.2. Header</a>.):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">fdt_header</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">magic</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">totalsize</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">off_dt_struct</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">off_dt_strings</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">off_mem_rsvmap</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">version</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">last_comp_version</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">boot_cpuid_phys</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size_dt_strings</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">size_dt_struct</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Please note that all the header fields are 32-bit integers, stored in big-endian format.</p>
<p>The stucture block can be further devided into several tokens, each containing its specific data.
Below is a simple example of the layout with token descriptions.
For more implementation details, please refer to (<a class="reference external" href="https://devicetree-specification.readthedocs.io/en/stable/flattened-format.html#structure-block">5.4. Structure Block</a>.)</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="n">soc</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// FDT_BEGIN_NODE &quot;soc&quot;</span>
<span class="w">  </span><span class="n">compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;simple-bus&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// FDT_PROP</span>
<span class="w">  </span><span class="n">interrupt</span><span class="o">-</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&amp;</span><span class="n">intc</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">// FDT_PROP</span>
<span class="w">  </span><span class="nl">intc</span><span class="p">:</span><span class="w"> </span><span class="n">interrupt</span><span class="o">-</span><span class="n">controller</span><span class="err">@</span><span class="n">f8f01000</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// FDT_BEGIN_NODE &quot;interrupt-controller@f8f01000&quot;</span>
<span class="w">  </span><span class="n">compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;arm,cortex-a9-gic&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// FDT_PROP</span>
<span class="w">  </span><span class="n">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="mh">0xF8F01000</span><span class="w"> </span><span class="mh">0x1000</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="c1">// FDT_PROP</span>
<span class="w">  </span><span class="o">&lt;</span><span class="mh">0xF8F00100</span><span class="w"> </span><span class="mh">0x100</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span><span class="w"> </span><span class="c1">// FDT_END_NODE</span>
<span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// FDT_END_NODE</span>
<span class="p">};</span><span class="w"> </span><span class="c1">// FDT_END</span>
</pre></div>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Implement a parser that can iterate the device tree. Also, provide an API that takes a callback function, so the driver code can access the content of the device node during device tree iteration.</p>
</div>
<p>The folloing code is a breif example of the API. You can design it in your own way.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">initramfs_callback</span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fdt_traverse</span><span class="p">(</span><span class="n">initramfs_callback</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Use the API to get the address of initramfs instead of hardcoding it. The initramfs address is located in the /chosen/linux,initrd-start node.</p>
</div>
</section>
<section id="dtb-loading">
<h4>Dtb Loading<a class="headerlink" href="#dtb-loading" title="Link to this heading">#</a></h4>
<p>A bootloader loads a dtb into memory and passes the loading address specified at register <code class="docutils literal notranslate"><span class="pre">x0</span></code> to the kernel.
Besides, it modifies the original dtb content to match the actual machine setting.
For example, it adds the initial ramdisk’s loading address in dtb if you ask the bootloader to load an initial ramdisk.</p>
<p><strong>QEMU</strong></p>
<p>Add the argument <code class="docutils literal notranslate"><span class="pre">-dtb</span> <span class="pre">bcm2710-rpi-3-b-plus.dtb</span></code> to QEMU.</p>
<p><strong>Rpi3</strong></p>
<p>Move <code class="docutils literal notranslate"><span class="pre">bcm2710-rpi-3-b-plus.dtb</span></code> into SD card.</p>
<div class="admonition-todo admonition">
<p class="admonition-title">Todo</p>
<p>Modify your bootloader for passing the device tree loading address.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may use assembly to store and retrieve the x0 register for the initramfs address.</p>
</div>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 1: Hello World</p>
      </div>
    </a>
    <a class="right-next"
       href="lab3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 3: Exception and Interrupt</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-of-this-lab">Goals of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-a-kernel-is-loaded-on-rpi3">How a Kernel is Loaded on Rpi3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercises">Basic Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-1-reboot-10">Basic Exercise 1 - Reboot - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-2-uart-bootloader-30">Basic Exercise 2 - UART Bootloader - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#config-kernel-loading-setting">Config Kernel Loading Setting</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-3-initial-ramdisk-30">Basic Exercise 3 - Initial Ramdisk - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#new-ascii-format-cpio-archive">New ASCII Format Cpio Archive</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-cpio-archive">Loading Cpio Archive</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-4-simple-allocator-10">Basic Exercise 4 - Simple Allocator - 10%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercises">Advanced Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-1-bootloader-self-relocation-10">Advanced Exercise 1 - Bootloader Self Relocation - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-2-devicetree-30">Advanced Exercise 2 - Devicetree - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#format">Format</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing">Parsing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dtb-loading">Dtb Loading</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By  NYCU cas-lab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, NYCU cas-lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>